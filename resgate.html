<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Legends - Resgate</title>
    <style>
        :root {
            --ouro: #c89b3c;
            --ouro-brilhante: #f0e6d2;
            --fundo-profundo: #010a13;
            --card-azul: #091428;
            --borda-azul: #1e2328;
        }

        body { 
            background: var(--fundo-profundo); 
            color: white; 
            font-family: 'Segoe UI', sans-serif; 
            margin: 0; 
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .header {
            width: 100%;
            max-width: 500px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 2px solid var(--ouro);
            margin-bottom: 20px;
        }

        .gold-display {
            color: var(--ouro);
            font-weight: bold;
            font-size: 1.2rem;
            text-shadow: 0 0 10px rgba(200, 155, 60, 0.5);
        }

        .container {
            width: 100%;
            max-width: 500px;
            padding-bottom: 100px; /* Espa√ßo para o rodap√© de an√∫ncio */
        }

        .card {
            background: var(--card-azul);
            border: 1px solid var(--ouro);
            padding: 20px;
            margin-bottom: 15px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .card h3 {
            margin-top: 0;
            color: var(--ouro-brilhante);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn-resgate {
            background: linear-gradient(to bottom, #c89b3c 0%, #a07a2d 100%);
            color: #010a13;
            border: none;
            padding: 10px 20px;
            font-weight: bold;
            cursor: pointer;
            text-transform: uppercase;
            width: 100%;
            margin-top: 10px;
        }

        /* ESTILO DO BOT√ÉO DE AN√öNCIO */
        .btn-anuncio {
            background: #1e2328;
            color: var(--ouro);
            border: 1px solid var(--ouro);
            padding: 15px;
            width: 100%;
            font-weight: bold;
            cursor: pointer;
            margin-top: 5px;
            transition: 0.3s;
        }

        .btn-anuncio:hover {
            background: var(--ouro);
            color: black;
        }

        /* RODAP√â PARA AN√öNCIO (ESPA√áO RESERVADO) */
        #footer-ad {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 70px;
            background: #000;
            border-top: 1px solid var(--ouro);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 999;
        }
    </style>
</head>
<body>

    <div class="header">
        <span id="nomeUsuario">CARREGANDO...</span>
        <span class="gold-display">üí∞ <span id="saldoGold">0</span></span>
    </div>

    <div class="container">
        <div class="card">
            <h3>B√¥nus Di√°rio</h3>
            <p>Assista a um v√≠deo promocional e ganhe Gold instantaneamente!</p>
            <button class="btn-anuncio" id="btnAnuncio">ASSISTIR AN√öNCIO (+300 GOLD)</button>
        </div>

        <div class="card">
            <h3>Resgate PIX - R$ 10,00</h3>
            <p>Custo: 10.000 Gold</p>
            <button class="btn-resgate" onclick="solicitarResgate(10)">RESGATAR</button>
        </div>

        <div class="card">
            <h3>Resgate PIX - R$ 20,00</h3>
            <p>Custo: 20.000 Gold</p>
            <button class="btn-resgate" onclick="solicitarResgate(20)">RESGATAR</button>
        </div>
    </div>

    <div id="footer-ad">
        <span style="font-size: 10px; color: #555;">PUBLICIDADE</span>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
        import { getFirestore, doc, getDoc, updateDoc } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyC4dm0KoyJswhyCY7tgbF4D2nmuZl84X8E",
            authDomain: "quizlegends-f58fc.firebaseapp.com",
            projectId: "quizlegends-f58fc",
            storageBucket: "quizlegends-f58fc.firebasestorage.app",
            messagingSenderId: "1050463164018",
            appId: "1:1050463164018:web:91de002b8afc8e678f54eb"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        const usuarioLogado = localStorage.getItem("usuarioLogado");

        if (!usuarioLogado) {
            window.location.href = "index.html";
        }

        // Carregar dados do usu√°rio
        async function carregarDados() {
            const userRef = doc(db, "usuarios", usuarioLogado);
            const userSnap = await getDoc(userRef);
            if (userSnap.exists()) {
                document.getElementById('nomeUsuario').innerText = usuarioLogado.toUpperCase();
                document.getElementById('saldoGold').innerText = userSnap.data().gold || 0;
            }
        }

        carregarDados();

        // --- L√ìGICA DO AN√öNCIO SMARTLINK ---
        const linkAnuncio = "https://www.effectivegatecpm.com/jt82yz19rk?key=427afd02462871777b7bf2742e74b44f";

        document.getElementById('btnAnuncio').onclick = () => {
            // 1. Abre o an√∫ncio da Adsterra
            window.open(linkAnuncio, '_blank');

            // 2. Cr√©dito do Gold (Simulando que ele assistiu)
            setTimeout(async () => {
                try {
                    const userRef = doc(db, "usuarios", usuarioLogado);
                    const userSnap = await getDoc(userRef);
                    const novoGold = (userSnap.data().gold || 0) + 300;

                    await updateDoc(userRef, { gold: novoGold });
                    
                    alert("Voc√™ recebeu 300 Gold pela visualiza√ß√£o!");
                    location.reload(); 
                } catch (e) {
                    alert("Erro ao processar recompensa.");
                }
            }, 3000); // 3 segundos de delay para o usu√°rio ver o an√∫ncio abrir
        };

        // Fun√ß√£o de resgate (Exemplo)
        window.solicitarResgate = (valor) => {
            alert("Saldo insuficiente para resgatar R$ " + valor + ",00. Continue jogando!");
        };

    </script>
</body>
</html>
